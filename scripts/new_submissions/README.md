## Скрипты для оповещения о новых посылках

Для работы всех скриптов необходимо авторизоввться с правами проверяющего:

```bash
kks auth --judge
```

### `utils/submissions.py`

В файле содержатся вспомогательные функции для получения списка новых посылок.

- `new_submissions()` - возвращает список новых посылок в хронологическом порядке.
- `save_last_id(submissions, id_file=None)` - обновляет сохранённый id последней посылки. В качестве аргумента `submissions` должен передаваться результат вызова `new_submissions()`.

### `legacy/telegram_simple_post.py`

При запуске отправляет сообщения о новых посылках в телеграм-чат/канал.

Используются переменные окружения: `EJUDGE_TELEGRAM_TOKEN` - токен для бота, `EJUDGE_TELEGRAM_CHAT` - id чата/канала.

### `legacy/telegram_bot.py` (старая версия)

Запускает telegram-бота, который раз в час отправляет сообщения о новых посылках. К сообщениям прикрепляются кнопки (для возможности распределения посылок между проверяющими).

Для запуска требуется `python-telegram-bot` (можно установить через requirements).

```bash
pip install -r bot-requirements.txt
```

### `telegram_bot.py`

Обновлённый бот. Отличия от 1-й версии:
- При проверке всех посылок старые сообщения удаляются, чтобы не засорять чат/канал.
- Бот хранит статистику по проверенным посылкам, поддерживается выгрузка в CSV.
- Для повторных посылок (с исправлениями реджектов) добавляется информация о проверяющем, от которого был получен реджект.
